# Migration 目錄說明

## 📁 目錄狀態：已整理完成

此目錄原本包含數個資料庫遷移檔案，用於從初始版本逐步升級到目前的最終版本。由於資料庫結構已經穩定，不再需要這些歷史 migration 檔案。

## 🗂️ 保留檔案

### `fix-rls-policy.sql`

**用途**：修復生產環境中可能遇到的 RLS 政策問題

- 解決「部分貓咪關聯保存失敗」錯誤
- 適用於已部署的資料庫需要修復 RLS 政策時使用
- **保留原因**：可能在生產環境故障排除時需要

### `prevent-duplicate-calculations.sql`

**用途**：防止重複計算記錄的資料庫函數

- 建立 trigger 防止 30 秒內重複提交相同資料
- 可選功能，用於提升資料品質
- **保留原因**：可能在未來需要防重複功能時使用

## 🆕 新專案部署

對於新的部署，請直接使用根目錄的 `supabase-schema.sql`，它已包含所有必要的資料庫結構：

```sql
-- 完整的資料庫結構，包含：
-- ✅ 用戶認證相關表
-- ✅ 貓咪管理表（含頭像、生日欄位）
-- ✅ 營養計算表（含所有營養成分欄位）
-- ✅ 多貓關聯表
-- ✅ 所有 RLS 政策
-- ✅ 必要的索引
```

詳細部署步驟請參考 [DEPLOYMENT.md](../DEPLOYMENT.md)。
